
// Start function for Microfrontend: <%-spec.microfrontends[i].name%>
export async function start<%-safeMicrofrontendNames[i]-%>(hostElementId: string, overrideConfig?: Partial<<%-configSchemaTypes[i].ifName-%>>) {
    const clientServices = (window as any).MashroomPortalServices as MashroomPortalClientServices | undefined;
    if (!clientServices) {
        throw new Error('[OpenMicrofrontends] Mashroom Portal not available!');
    }

    const portalApp = await clientServices.portalAppService.loadApp(hostElementId, '<%-spec.microfrontends[i].name%>', undefined, undefined, overrideConfig);

    return {
        id: portalApp.id,
        close: async () => {
            await clientServices.portalAppService.unloadApp(portalApp.id);
        },
        <% if (spec.microfrontends[i].messages && Object.keys(spec.microfrontends[i].messages).length > 0) { %>
        messages: clientServices.messageBus as Microfrontend<%-i+1-%>ClientMessageBus,
        <% } %>
    };
}
