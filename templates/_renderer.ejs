

/* --- Microfrontend <%- i+1 -%> --- */

/* Type Parameters */

<% if (spec.microfrontends[i].userPermissions && spec.microfrontends[i].userPermissions.permissions.length > 0) { %>
    export type Microfrontend<%-i+1 -%>Permissions = {
    <% spec.microfrontends[i].userPermissions.permissions.forEach((permission) => { %>
    readonly '<%-permission.name%>': boolean;
    <% }) %>
    };
<% } else { %>
    export type Microfrontend<%-i+1 %>Permissions = undefined;
<%  } %>

<% if (spec.microfrontends[i].apiProxies && Object.keys(spec.microfrontends[i].apiProxies).length > 0) { %>
    type Microfrontend<%-i+1 %>ApiProxyPaths = {
    <% Object.keys(spec.microfrontends[i].apiProxies).forEach((proxyId) => { %>
    readonly '<%-proxyId%>': string;
    <% }) %>
    };
<% } else { %>
    type Microfrontend<%-i+1 %>ApiProxyPaths = undefined;
<%  } %>

<% if (spec.microfrontends[i].messages && Object.keys(spec.microfrontends[i].messages).length > 0) { %>
    type Microfrontend<%-i+1 %>MessagesPublish = {
    <% Object.keys(spec.microfrontends[i].messages).forEach((topic, idx) => { %>
        <% if (spec.microfrontends[i].messages[topic].publish) { %>
        '<%-topic-%>%>': <%-messageSchemaTypes[idx][topic].ifName-%>;
        <% } %>
    <% }); %>
    }
    type Microfrontend<%-i+1 %>MessagesSubscribe = {
    <% Object.keys(spec.microfrontends[i].messages).forEach((topic, idx) => { %>
        <% if (spec.microfrontends[i].messages[topic].subscribe) { %>
        '<%-topic-%>%>': <%-messageSchemaTypes[idx][topic].ifName-%>;
        <% } %>
    <% }); %>
    }
<% } else { %>
    type Microfrontend<%-i+1 %>MessagesPublish = undefined;
    type Microfrontend<%-i+1 %>MessagesSubscribe = undefined;
<%  } %>

/* Renderer */

export type <%-safeMicrofrontendNames[i]%>Renderer = OpenMicrofrontendsRenderer<Microfrontend<%-i+1%>Config, Microfrontend<%-i+1%>Permissions, Microfrontend<%-i+1%>ApiProxyPaths, Microfrontend<%-i+1%>MessagesPublish, Microfrontend<%-i+1%>MessagesSubscribe>;

export const <%-safeMicrofrontendNames[i]%>RendererFunctionName = '<%-spec.microfrontends[i].rendererFunctionName%>';

/* Path constants */

export const <%-safeMicrofrontendNames[i]%>AssetsBasePath = '<%-spec.microfrontends[i].assets.basePath ?? '/'%>';
<% if (spec.microfrontends[i].assets.buildManifestPath) { %>
    export const <%-safeMicrofrontendNames[i]%>BuildManifestPath = '<%-spec.microfrontends[i].assets.buildManifestPath%>';
<%  } %>
<% if (spec.microfrontends[i].userPermissions?.provided) { %>
    export const <%-safeMicrofrontendNames[i]%>UserPermissionsPath = '<%-spec.microfrontends[i].userPermissions.provided.path%>';
<%  } %>

